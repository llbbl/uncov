{"id":"uncov-0lq","title":"Create install.sh script for easy binary installation","description":"Create install.sh for curl-based installation.\n\n**Usage:**\n```bash\ncurl -fsSL https://raw.githubusercontent.com/llbbl/uncov/main/install.sh | bash\n```\n\n**Script Behavior:**\n1. Detect OS and architecture\n2. Download appropriate binary from GitHub releases\n3. Install to ~/.local/bin or /usr/local/bin\n4. Verify binary works (uncov --version)\n5. Print success message with PATH instructions if needed\n\n**Platform Detection:**\n```bash\nOS=$(uname -s | tr '[:upper:]' '[:lower:]')\nARCH=$(uname -m)\n# Map to our naming: darwin-arm64, darwin-x64, linux-x64\n```\n\n**Installation Locations:**\n1. If ~/.local/bin exists and is in PATH → install there\n2. Else if user has write access to /usr/local/bin → install there\n3. Else → install to ~/.local/bin and warn about PATH\n\n**Error Handling:**\n- Unsupported platform → clear error message\n- Download failed → retry once, then fail with URL\n- Checksum mismatch → fail with warning\n\n**Success Output:**\n```\nDetected: darwin-arm64\nDownloading uncov v0.1.0...\nInstalling to /usr/local/bin/uncov...\n✓ uncov v0.1.0 installed successfully\\!\n\nRun 'uncov --help' to get started.\n```","status":"open","priority":3,"issue_type":"task","created_at":"2026-02-02T20:55:05.235861-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T20:55:05.235861-06:00","dependencies":[{"issue_id":"uncov-0lq","depends_on_id":"uncov-kah","type":"blocks","created_at":"2026-02-02T20:56:17.955806-06:00","created_by":"loganlindquist"}]}
{"id":"uncov-0ou","title":"Create Homebrew tap for uncov distribution","description":"Create Homebrew tap repository for easy macOS installation (v0.3.0 goal).\n\n**Repository:** homebrew-uncov (separate repo)\n\n**Formula: uncov.rb**\n```ruby\nclass Uncov \u003c Formula\n  desc \"CLI tool to report files with low test coverage\"\n  homepage \"https://github.com/llbbl/uncov\"\n  version \"0.1.0\"\n\n  on_macos do\n    if Hardware::CPU.arm?\n      url \"https://github.com/llbbl/uncov/releases/download/v0.1.0/uncov-darwin-arm64\"\n      sha256 \"\u003csha256\u003e\"\n    else\n      url \"https://github.com/llbbl/uncov/releases/download/v0.1.0/uncov-darwin-x64\"\n      sha256 \"\u003csha256\u003e\"\n    end\n  end\n\n  on_linux do\n    url \"https://github.com/llbbl/uncov/releases/download/v0.1.0/uncov-linux-x64\"\n    sha256 \"\u003csha256\u003e\"\n  end\n\n  def install\n    bin.install \"uncov-darwin-arm64\" =\u003e \"uncov\" if OS.mac? \u0026\u0026 Hardware::CPU.arm?\n    bin.install \"uncov-darwin-x64\" =\u003e \"uncov\" if OS.mac? \u0026\u0026 !Hardware::CPU.arm?\n    bin.install \"uncov-linux-x64\" =\u003e \"uncov\" if OS.linux?\n  end\n\n  test do\n    assert_match \"uncov\", shell_output(\"#{bin}/uncov --version\")\n  end\nend\n```\n\n**Installation:**\n```bash\nbrew tap llbbl/uncov\nbrew install uncov\n```\n\n**Automation:**\n- Update formula SHA256 on each release\n- Can be automated via GitHub Actions","status":"open","priority":4,"issue_type":"task","created_at":"2026-02-02T20:55:28.308201-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T20:55:28.308201-06:00","dependencies":[{"issue_id":"uncov-0ou","depends_on_id":"uncov-kah","type":"blocks","created_at":"2026-02-02T20:56:18.068068-06:00","created_by":"loganlindquist"}]}
{"id":"uncov-0xe","title":"Fix: Extract default coverage path to constant","description":"**Severity:** Low\n**Location:** src/cli.ts line 55-56\n\n**Issue:** Default coverage path 'coverage/coverage-summary.json' is a magic string.\n\n**The Fix:**\n```typescript\n// At top of file or in constants\nconst DEFAULT_COVERAGE_PATH = 'coverage/coverage-summary.json';\n\n// In parseArgs options:\n'coverage-path': {\n    type: 'string',\n    short: 'c',\n    default: DEFAULT_COVERAGE_PATH,\n},\n```\n\n**Acceptance Criteria:**\n- Default path is a named constant\n- Constant is exported for use by other modules if needed","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-02-02T21:43:40.151488-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T21:47:19.675593-06:00","closed_at":"2026-02-02T21:47:19.675593-06:00","close_reason":"Closed"}
{"id":"uncov-17j","title":"Fix: Build script uses @ts-expect-error for compile option","description":"**Issue:** The build script uses @ts-expect-error to suppress a type issue with Bun.build compile option. Should use CLI approach instead.\n\n**Location:** scripts/build.ts lines 39-40\n\n**The Fix:**\nUse CLI via Bun.spawn instead of Bun.build API:\n```typescript\nasync function build(): Promise\u003cvoid\u003e {\n  const distDir = './dist';\n  await mkdir(distDir, { recursive: true });\n\n  console.log('Building uncov for all platforms...\\n');\n\n  for (const { target, outfile } of TARGETS) {\n    console.log(`Building ${target}...`);\n    \n    const proc = Bun.spawn([\n      'bun', 'build', '--compile',\n      '--target', target,\n      '--outfile', `${distDir}/${outfile}`,\n      './src/cli.ts'\n    ], {\n      stdout: 'inherit',\n      stderr: 'inherit',\n    });\n    \n    const exitCode = await proc.exited;\n    if (exitCode !== 0) {\n      console.error(`Failed to build ${target}`);\n      process.exit(1);\n    }\n    \n    console.log(`  -\u003e ${distDir}/${outfile}`);\n  }\n\n  console.log('\\nBuild complete!');\n}\n```\n\n**Acceptance Criteria:**\n- No @ts-expect-error in build script\n- `bun run scripts/build.ts` works correctly\n- Build produces binaries in dist/","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-02-02T21:16:17.371737-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T21:21:13.517263-06:00","closed_at":"2026-02-02T21:21:13.517263-06:00","close_reason":"Closed"}
{"id":"uncov-1e5","title":"Critical: Add path validation to prevent directory traversal","description":"**Severity:** Critical\n**Location:** src/utils/fs.ts (all file operations)\n\n**Issue:** File utilities accept arbitrary paths without validation. Could allow reading/writing files outside project directory via path traversal (e.g., `../../../etc/passwd`).\n\n**The Fix:**\n```typescript\nimport { resolve, relative, isAbsolute } from 'node:path';\n\nexport function validatePath(targetPath: string, baseDir: string = process.cwd()): string {\n    const resolved = resolve(baseDir, targetPath);\n    const relativePath = relative(baseDir, resolved);\n    \n    if (relativePath.startsWith('..') || isAbsolute(relativePath)) {\n        throw new Error(`Path \"${targetPath}\" is outside allowed directory`);\n    }\n    \n    return resolved;\n}\n```\n\nApply validation to readJson, writeJson, readText, writeText, appendLine.\n\n**Acceptance Criteria:**\n- validatePath function exists and is tested\n- File operations validate paths when baseDir is provided\n- Attempting to access `../../../etc/passwd` throws error\n- Tests cover path traversal attempts","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-02-02T21:43:39.006322-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T21:46:27.659632-06:00","closed_at":"2026-02-02T21:46:27.659632-06:00","close_reason":"Closed"}
{"id":"uncov-2bo","title":"Implement init command: bootstrap coverage configuration","description":"Create src/commands/init.ts - the `uncov init` command for v0.2.0.\n\n**CLI Flags:**\n- `--force` - Overwrite existing configuration\n\n**Interactive Flow:**\n1. Detect package manager (pnpm \u003e bun \u003e npm \u003e yarn)\n2. Check for existing vitest config\n3. If exists and no --force: prompt to add coverage config\n4. If doesn't exist: create new vitest.config.ts\n5. Add scripts to package.json\n6. Add coverage/ to .gitignore\n\n**Actions Performed:**\n1. **Detect environment**\n   - Package manager from lockfiles\n   - Existing vitest/vite config\n\n2. **Update package.json**\n   - Add `test:coverage`: 'vitest run --coverage'\n   - Add `coverage:low`: 'uncov'\n   - Skip existing scripts (report which)\n\n3. **Configure vitest**\n   - Create or update vitest.config.ts with:\n   ```typescript\n   coverage: {\n     provider: 'v8',\n     reporter: ['text', 'json-summary'],\n     reportsDirectory: './coverage',\n   }\n   ```\n\n4. **Update .gitignore**\n   - Add 'coverage/' if not present\n\n**Output:**\n```\n✓ Detected package manager: pnpm\n✓ Added script: test:coverage\n✓ Added script: coverage:low\n✓ Updated vitest.config.ts with coverage settings\n✓ Added coverage/ to .gitignore\n\nRun 'pnpm test:coverage' to generate coverage, then 'uncov' to see low coverage files.\n```\n\n**Error Handling:**\n- No package.json → error with instructions\n- Existing coverage config without --force → warn and skip\n\n**Tests Required:** test/commands/init.test.ts","status":"open","priority":2,"issue_type":"feature","created_at":"2026-02-02T20:53:10.323176-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T20:53:10.323176-06:00","dependencies":[{"issue_id":"uncov-2bo","depends_on_id":"uncov-mv8","type":"blocks","created_at":"2026-02-02T20:56:16.57644-06:00","created_by":"loganlindquist"},{"issue_id":"uncov-2bo","depends_on_id":"uncov-fn0","type":"blocks","created_at":"2026-02-02T20:56:16.688394-06:00","created_by":"loganlindquist"},{"issue_id":"uncov-2bo","depends_on_id":"uncov-s2m","type":"blocks","created_at":"2026-02-02T20:56:16.802375-06:00","created_by":"loganlindquist"},{"issue_id":"uncov-2bo","depends_on_id":"uncov-ocy","type":"blocks","created_at":"2026-02-02T20:56:16.914277-06:00","created_by":"loganlindquist"}]}
{"id":"uncov-2ur","title":"Critical: Add runtime validation for parsed JSON coverage data","description":"**Severity:** Critical\n**Location:** src/utils/fs.ts line 29, src/lib/coverage.ts\n\n**Issue:** `readJson\u003cT\u003e` uses `as T` type assertion without runtime validation. Malformed coverage-summary.json could cause runtime errors or security issues.\n\n**The Fix:**\nAdd validation functions in src/lib/coverage.ts:\n```typescript\nfunction isValidCoverageMetric(obj: unknown): obj is CoverageMetric {\n    if (typeof obj \\!== 'object' || obj === null) return false;\n    const metric = obj as Record\u003cstring, unknown\u003e;\n    return (\n        typeof metric.total === 'number' \u0026\u0026\n        typeof metric.covered === 'number' \u0026\u0026\n        typeof metric.pct === 'number'\n    );\n}\n\nfunction isValidFileCoverage(obj: unknown): obj is FileCoverage {\n    if (typeof obj \\!== 'object' || obj === null) return false;\n    const coverage = obj as Record\u003cstring, unknown\u003e;\n    return isValidCoverageMetric(coverage.lines);\n}\n\nexport function parseCoverageSummary(data: unknown): CoverageSummary {\n    if (typeof data \\!== 'object' || data === null) {\n        throw new Error('Coverage summary must be an object');\n    }\n    \n    const summary = data as Record\u003cstring, unknown\u003e;\n    \n    if (\\!isValidFileCoverage(summary.total)) {\n        throw new Error('Coverage summary missing valid \"total\" field');\n    }\n    \n    return summary as CoverageSummary;\n}\n```\n\n**Acceptance Criteria:**\n- parseCoverageSummary validates structure at runtime\n- Invalid coverage data throws descriptive errors\n- coverage-summary-missing-fields.json fixture is used in tests\n- Tests verify error messages for various invalid inputs","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-02-02T21:43:39.39318-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T21:46:27.689365-06:00","closed_at":"2026-02-02T21:46:27.689365-06:00","close_reason":"Closed"}
{"id":"uncov-38c","title":"Implement report command: default CLI command for coverage reporting","description":"Create src/commands/report.ts - the default command when running `uncov`.\n\n**CLI Flags:**\n- `--threshold \u003cn\u003e` (default: 10) - Show files at or below this line coverage %\n- `--fail` - Exit code 1 if any files below threshold\n- `--json` - Output JSON instead of table\n- `--coverage-path \u003cpath\u003e` (default: coverage/coverage-summary.json)\n\n**Implementation:**\n1. Parse CLI args using util.parseArgs\n2. Read coverage-summary.json via coverage.ts\n3. Filter files at or below threshold\n4. Sort by percentage ascending\n5. Format and output results\n6. Exit with appropriate code\n\n**Exit Codes:**\n- 0: Success (or low coverage found but --fail not set)\n- 1: Low coverage found AND --fail set\n- 2: Missing coverage file or config error\n\n**Output Formats:**\nTable (default):\n```\nFiles at or below 10% line coverage: 3\n\n  0.00%  LH    0/LF  120   src/renderer.ts\n  5.26%  LH    2/LF   38   src/bootstrap.ts\n 10.00%  LH   10/LF  100   src/engine.ts\n```\n\nJSON (--json):\n```json\n[{\"path\": \"src/renderer.ts\", \"percentage\": 0, \"linesHit\": 0, \"linesFound\": 120}, ...]\n```\n\n**Tests Required:** test/commands/report.test.ts","status":"open","priority":1,"issue_type":"feature","created_at":"2026-02-02T20:52:30.298274-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T20:52:30.298274-06:00","dependencies":[{"issue_id":"uncov-38c","depends_on_id":"uncov-p0r","type":"blocks","created_at":"2026-02-02T20:56:15.969029-06:00","created_by":"loganlindquist"},{"issue_id":"uncov-38c","depends_on_id":"uncov-q77","type":"blocks","created_at":"2026-02-02T20:56:16.083298-06:00","created_by":"loganlindquist"},{"issue_id":"uncov-38c","depends_on_id":"uncov-brm","type":"blocks","created_at":"2026-02-02T20:56:16.1985-06:00","created_by":"loganlindquist"},{"issue_id":"uncov-38c","depends_on_id":"uncov-ocy","type":"blocks","created_at":"2026-02-02T20:56:16.310572-06:00","created_by":"loganlindquist"}]}
{"id":"uncov-3ky","title":"Project scaffolding: create src directory structure and base files","description":"Create the initial project structure as defined in the spec:\n\n**Directory Structure:**\n- src/cli.ts - Entry point with arg parsing\n- src/commands/ - Command implementations directory\n- src/lib/ - Core logic directory\n- src/utils/ - Helper utilities directory\n- test/ - Test directory\n- test/fixtures/ - Sample coverage files for testing\n- scripts/ - Build scripts directory\n\n**Base Files to Create:**\n- src/cli.ts with basic structure (parseArgs setup, command routing skeleton)\n- Export barrel files where needed\n\n**Acceptance Criteria:**\n- All directories exist\n- cli.ts has basic structure with parseArgs from util\n- Project compiles with `bun build`","status":"closed","priority":0,"issue_type":"task","created_at":"2026-02-02T20:52:04.777657-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T21:21:13.825666-06:00","closed_at":"2026-02-02T21:21:13.825666-06:00","close_reason":"Closed"}
{"id":"uncov-77g","title":"Add: Unit tests for format utilities","description":"**Issue:** The formatting utilities (formatPercent, formatLines, formatFileLine, formatReport) have implementations but no unit tests. These pure functions are ideal for unit testing.\n\n**Location:** Create test/format.test.ts\n\n**Tests to Add:**\n```typescript\nimport { describe, expect, it } from 'bun:test';\nimport { formatPercent, formatLines, formatFileLine, formatReport } from '../src/utils/format';\n\ndescribe('formatPercent', () =\u003e {\n  it('should format 0% correctly', () =\u003e {\n    expect(formatPercent(0)).toBe('  0.00%');\n  });\n  \n  it('should format 100% correctly', () =\u003e {\n    expect(formatPercent(100)).toBe('100.00%');\n  });\n  \n  it('should format decimal percentages', () =\u003e {\n    expect(formatPercent(5.26)).toBe('  5.26%');\n  });\n});\n\ndescribe('formatLines', () =\u003e {\n  it('should format line counts with padding', () =\u003e {\n    expect(formatLines(10, 100)).toBe('LH   10/LF  100');\n  });\n});\n\ndescribe('formatReport', () =\u003e {\n  it('should show message when no files below threshold', () =\u003e {\n    expect(formatReport([], 10)).toBe('No files at or below 10% line coverage.');\n  });\n});\n```\n\n**Acceptance Criteria:**\n- test/format.test.ts exists with comprehensive tests\n- All format functions have test coverage\n- Tests pass with `bun test`","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-02T21:16:16.073855-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T21:21:13.486121-06:00","closed_at":"2026-02-02T21:21:13.486121-06:00","close_reason":"Closed"}
{"id":"uncov-a4f","title":"Fix: Import version from package.json instead of hardcoding","description":"**Issue:** Version string '0.1.0' is duplicated in package.json and cli.ts (line 11). Creates maintenance burden and version mismatch risk.\n\n**Location:** src/cli.ts line 11\n\n**The Fix:**\n```typescript\n// src/cli.ts - Import version from package.json\nimport pkg from '../package.json' with { type: 'json' };\n\nconst VERSION = pkg.version;\n```\n\n**Acceptance Criteria:**\n- VERSION constant reads from package.json\n- `bun run dev -- --version` shows correct version\n- No duplicate version strings in codebase","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-02T21:14:49.603492-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T21:19:02.454726-06:00","closed_at":"2026-02-02T21:19:02.454726-06:00","close_reason":"Closed"}
{"id":"uncov-b90","title":"Implement build script for cross-platform binaries","description":"Create scripts/build.ts for building cross-platform binaries.\n\n**Target Platforms:**\n- darwin-arm64 (macOS Apple Silicon)\n- darwin-x64 (macOS Intel)\n- linux-x64 (Linux)\n- windows-x64 (Windows)\n\n**Build Command:**\n```bash\nbun build --compile --target=bun-{platform}-{arch} --outfile=dist/uncov-{platform}-{arch}\n```\n\n**Script Features:**\n1. Clean dist/ directory before build\n2. Build for all platforms in parallel\n3. Report success/failure for each target\n4. Generate checksums (SHA256) for each binary\n\n**Output Structure:**\n```\ndist/\n├── uncov-darwin-arm64\n├── uncov-darwin-arm64.sha256\n├── uncov-darwin-x64\n├── uncov-darwin-x64.sha256\n├── uncov-linux-x64\n├── uncov-linux-x64.sha256\n├── uncov-windows-x64.exe\n└── uncov-windows-x64.exe.sha256\n```\n\n**Package.json Scripts:**\n```json\n{\n  \"build:local\": \"bun build --compile --outfile=dist/uncov ./src/cli.ts\",\n  \"build:all\": \"bun run scripts/build.ts\"\n}\n```\n\n**Tests:** Manual verification (build and run on local platform)","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-02T20:54:53.709579-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T20:54:53.709579-06:00","dependencies":[{"issue_id":"uncov-b90","depends_on_id":"uncov-38c","type":"blocks","created_at":"2026-02-02T20:56:17.734343-06:00","created_by":"loganlindquist"}]}
{"id":"uncov-brm","title":"Implement config.ts: read uncov configuration","description":"Create src/lib/config.ts to handle configuration loading.\n\n**Config Sources (priority order):**\n1. CLI flags (highest priority)\n2. `uncov.config.json` in project root\n3. `uncov` field in `package.json`\n4. Defaults (lowest priority)\n\n**Config Schema:**\n```typescript\ninterface UncovConfig {\n  threshold: number;      // default: 10\n  exclude: string[];      // glob patterns to exclude\n  failOnLow: boolean;     // default: false\n  coveragePath: string;   // default: 'coverage/coverage-summary.json'\n}\n```\n\n**Functions to Implement:**\n- `loadConfig(cliOverrides?: Partial\u003cUncovConfig\u003e): UncovConfig`\n- `findConfigFile(): string | null` - Look for uncov.config.json\n- `readPackageJsonConfig(): Partial\u003cUncovConfig\u003e | null`\n- `mergeConfigs(...configs: Partial\u003cUncovConfig\u003e[]): UncovConfig`\n\n**Config File Format:**\n```json\n{\n  \"threshold\": 20,\n  \"exclude\": [\"**/*.test.ts\", \"**/index.ts\"],\n  \"failOnLow\": false\n}\n```\n\n**Tests Required:** test/lib/config.test.ts","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-02T20:52:30.772821-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T20:52:30.772821-06:00","dependencies":[{"issue_id":"uncov-brm","depends_on_id":"uncov-3ky","type":"blocks","created_at":"2026-02-02T20:56:08.061163-06:00","created_by":"loganlindquist"},{"issue_id":"uncov-brm","depends_on_id":"uncov-ed6","type":"blocks","created_at":"2026-02-02T20:56:08.174383-06:00","created_by":"loganlindquist"}]}
{"id":"uncov-cgy","title":"Improve: Add exit code assertions to CLI tests","description":"**Issue:** Tests spawn processes and check stdout but don't verify exit codes. Need to assert on exit codes for proper testing.\n\n**Location:** test/cli.test.ts (all test cases)\n\n**The Fix:**\n```typescript\nit('should show version with --version flag', async () =\u003e {\n  const proc = Bun.spawn(['bun', 'run', './src/cli.ts', '--version'], {\n    cwd: `${import.meta.dir}/..`,\n    stdout: 'pipe',\n    stderr: 'pipe',\n  });\n  \n  const exitCode = await proc.exited;\n  const output = await new Response(proc.stdout).text();\n  \n  expect(exitCode).toBe(0);\n  expect(output.trim()).toBe('0.1.0');\n});\n```\n\n**Acceptance Criteria:**\n- All existing tests assert exit code 0\n- Add test for exit code 2 on invalid input\n- Tests check both stdout and exit codes","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-02T21:16:15.769078-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T21:21:13.456059-06:00","closed_at":"2026-02-02T21:21:13.456059-06:00","close_reason":"Closed"}
{"id":"uncov-e27","title":"Implement check command: verify coverage setup","description":"Create src/commands/check.ts - the `uncov check` command for v0.3.0.\n\n**Purpose:** Verify coverage setup is correct (useful for CI).\n\n**Checks Performed:**\n1. **Vitest config exists and has coverage settings**\n   - Look for vitest.config.* or vite.config.* with test section\n   - Verify coverage.reporter includes 'json-summary'\n   - Verify coverage.reportsDirectory is set\n\n2. **coverage-summary.json exists**\n   - Check default path: coverage/coverage-summary.json\n   - Or configured path from uncov config\n\n3. **Scripts are configured**\n   - Check for test:coverage or similar script\n   - Check for uncov script (optional)\n\n**Output (success):**\n```\n✓ Vitest config found: vitest.config.ts\n✓ Coverage reporter configured: json-summary\n✓ Coverage summary exists: coverage/coverage-summary.json\n✓ Scripts configured: test:coverage\n\nAll checks passed!\n```\n\n**Output (failure):**\n```\n✗ Coverage summary not found: coverage/coverage-summary.json\n  Run 'pnpm test:coverage' to generate coverage data\n\n1 check failed\n```\n\n**Exit Codes:**\n- 0: All checks pass\n- 1: One or more checks failed\n- 2: Configuration error\n\n**Tests Required:** test/commands/check.test.ts","status":"open","priority":3,"issue_type":"feature","created_at":"2026-02-02T20:53:10.561065-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T20:53:10.561065-06:00","dependencies":[{"issue_id":"uncov-e27","depends_on_id":"uncov-mv8","type":"blocks","created_at":"2026-02-02T20:56:17.164737-06:00","created_by":"loganlindquist"},{"issue_id":"uncov-e27","depends_on_id":"uncov-brm","type":"blocks","created_at":"2026-02-02T20:56:17.277445-06:00","created_by":"loganlindquist"},{"issue_id":"uncov-e27","depends_on_id":"uncov-p0r","type":"blocks","created_at":"2026-02-02T20:56:17.391548-06:00","created_by":"loganlindquist"},{"issue_id":"uncov-e27","depends_on_id":"uncov-ocy","type":"blocks","created_at":"2026-02-02T20:56:17.501771-06:00","created_by":"loganlindquist"}]}
{"id":"uncov-ed6","title":"Implement fs.ts: file system helper utilities","description":"Create src/utils/fs.ts for common file operations.\n\n**Functions to Implement:**\n\n`fileExists(path: string): boolean`\n- Check if file exists (sync)\n\n`readJson\u003cT\u003e(path: string): T`\n- Read and parse JSON file\n- Throw descriptive error on parse failure\n\n`writeJson(path: string, data: unknown): void`\n- Write JSON with 2-space indent\n- Ensure directory exists\n\n`readText(path: string): string`\n- Read text file contents\n\n`writeText(path: string, content: string): void`\n- Write text file\n- Ensure directory exists\n\n`ensureDir(path: string): void`\n- Create directory if it doesn't exist (recursive)\n\n`appendLine(path: string, line: string): void`\n- Append line to file (create if doesn't exist)\n- Handle trailing newline properly\n\n**Error Handling:**\n- All functions should throw descriptive errors\n- Include file path in error messages\n- Distinguish between 'not found' and 'permission denied'\n\n**Tests Required:** test/utils/fs.test.ts","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-02T20:54:32.981618-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T21:47:19.710033-06:00","closed_at":"2026-02-02T21:47:19.710033-06:00","close_reason":"Closed","dependencies":[{"issue_id":"uncov-ed6","depends_on_id":"uncov-3ky","type":"blocks","created_at":"2026-02-02T20:56:07.004481-06:00","created_by":"loganlindquist"}]}
{"id":"uncov-ejy","title":"Fix: Add threshold argument validation","description":"**Issue:** The threshold is parsed with Number.parseInt() but there's no validation for non-numeric input, negative values, or values over 100.\n\n**Location:** src/cli.ts line 84\n\n**The Fix:**\n```typescript\nfunction parseCliArgs(args: string[]): ParsedArgs {\n  // ... existing parseArgs code ...\n\n  const thresholdRaw = values.threshold ?? '10';\n  const threshold = Number.parseInt(thresholdRaw, 10);\n  \n  if (Number.isNaN(threshold)) {\n    console.error(`Error: Invalid threshold value \"${thresholdRaw}\". Must be a number.`);\n    process.exit(2);\n  }\n  \n  if (threshold \u003c 0 || threshold \u003e 100) {\n    console.error(`Error: Threshold must be between 0 and 100, got ${threshold}.`);\n    process.exit(2);\n  }\n\n  return {\n    // ... rest\n    threshold,\n  };\n}\n```\n\n**Acceptance Criteria:**\n- `uncov --threshold abc` shows error and exits 2\n- `uncov --threshold -10` shows error and exits 2\n- `uncov --threshold 150` shows error and exits 2\n- `uncov --threshold 50` works normally","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-02T21:15:52.495852-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T21:19:02.514569-06:00","closed_at":"2026-02-02T21:19:02.514569-06:00","close_reason":"Closed"}
{"id":"uncov-fn0","title":"Implement package-json.ts: safe package.json modification","description":"Create src/lib/package-json.ts for safely modifying package.json.\n\n**Functions to Implement:**\n\n`readPackageJson(path?: string): PackageJson`\n- Read and parse package.json\n- Handle missing file gracefully\n\n`writePackageJson(pkg: PackageJson, path?: string): void`\n- Write with consistent formatting (2-space indent)\n- Preserve existing formatting where possible\n\n`addScripts(scripts: Record\u003cstring, string\u003e): { added: string[]; skipped: string[] }`\n- Add scripts only if they don't exist\n- Return which were added vs skipped (already exist)\n\n`hasScript(name: string): boolean`\n- Check if a script exists\n\n**Scripts to Add (via init command):**\n```json\n{\n  \"test:coverage\": \"vitest run --coverage\",\n  \"coverage:low\": \"uncov\"\n}\n```\n\n**Safety:**\n- Never overwrite existing scripts without --force\n- Backup original before modification (optional)\n- Validate JSON before writing\n\n**Tests Required:** test/lib/package-json.test.ts","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-02T20:52:49.587304-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T20:52:49.587304-06:00","dependencies":[{"issue_id":"uncov-fn0","depends_on_id":"uncov-3ky","type":"blocks","created_at":"2026-02-02T20:56:08.757612-06:00","created_by":"loganlindquist"},{"issue_id":"uncov-fn0","depends_on_id":"uncov-ed6","type":"blocks","created_at":"2026-02-02T20:56:08.871325-06:00","created_by":"loganlindquist"}]}
{"id":"uncov-kah","title":"Create GitHub Actions CI workflow for testing and releases","description":"Create .github/workflows/ci.yml for automated testing and releases.\n\n**Workflow Triggers:**\n- Push to main\n- Pull requests to main\n- Tags matching v*.*.*\n\n**Jobs:**\n\n**1. Test Job**\n- Runs on: ubuntu-latest\n- Steps:\n  - Checkout\n  - Setup Bun\n  - Install dependencies (bun install)\n  - Run linter (bun run lint)\n  - Run tests (bun test)\n\n**2. Build Job** (on tag push only)\n- Runs on: matrix of [ubuntu-latest, macos-latest, windows-latest]\n- Steps:\n  - Checkout\n  - Setup Bun\n  - Build binary for platform\n  - Upload artifact\n\n**3. Release Job** (on tag push, after build)\n- Create GitHub release\n- Upload all binary artifacts\n- Generate release notes from commits\n\n**Release Artifact Names:**\n- uncov-darwin-arm64\n- uncov-darwin-x64\n- uncov-linux-x64\n- uncov-windows-x64.exe\n\n**Matrix Strategy:**\n```yaml\nstrategy:\n  matrix:\n    include:\n      - os: macos-latest\n        target: darwin-arm64\n      - os: macos-13\n        target: darwin-x64\n      - os: ubuntu-latest\n        target: linux-x64\n      - os: windows-latest\n        target: windows-x64\n```","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-02T20:54:53.956377-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T20:54:53.956377-06:00","dependencies":[{"issue_id":"uncov-kah","depends_on_id":"uncov-b90","type":"blocks","created_at":"2026-02-02T20:56:17.845049-06:00","created_by":"loganlindquist"}]}
{"id":"uncov-mv8","title":"Implement detect.ts: package manager and config detection","description":"Create src/lib/detect.ts for detecting project environment.\n\n**Functions to Implement:**\n\n`detectPackageManager(): 'pnpm' | 'bun' | 'npm' | 'yarn'`\n- Check for lockfiles in priority order:\n  1. pnpm-lock.yaml → 'pnpm'\n  2. bun.lockb → 'bun'\n  3. package-lock.json → 'npm'\n  4. yarn.lock → 'yarn'\n- Default to 'npm' if none found\n\n`detectVitestConfig(): { path: string; type: 'ts' | 'js' | 'mts' | 'mjs' } | null`\n- Look for vitest.config.{ts,js,mts,mjs}\n- Also check vite.config.* with test section\n\n`detectExistingCoverageConfig(): boolean`\n- Check if vitest config already has coverage settings\n\n`detectGitignore(): { exists: boolean; hasCoverage: boolean }`\n- Check if .gitignore exists\n- Check if 'coverage/' or 'coverage' is already listed\n\n**Tests Required:** test/lib/detect.test.ts","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-02T20:52:49.344921-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T20:52:49.344921-06:00","dependencies":[{"issue_id":"uncov-mv8","depends_on_id":"uncov-3ky","type":"blocks","created_at":"2026-02-02T20:56:08.40956-06:00","created_by":"loganlindquist"},{"issue_id":"uncov-mv8","depends_on_id":"uncov-ed6","type":"blocks","created_at":"2026-02-02T20:56:08.52271-06:00","created_by":"loganlindquist"}]}
{"id":"uncov-o9j","title":"Fix: Remove duplicate fileExists function from detect.ts","description":"**Issue:** There are two fileExists functions - one stub in detect.ts (line 28) and one implemented in utils/fs.ts (line 12). This violates DRY and will cause confusion.\n\n**Locations:**\n- src/lib/detect.ts line 28 (stub - REMOVE)\n- src/utils/fs.ts line 12 (implementation - KEEP)\n\n**The Fix:**\nRemove the stub from detect.ts and import from utils:\n```typescript\n// src/lib/detect.ts\nimport { fileExists } from '../utils/fs';\n\n// Then use fileExists() in detectPackageManager implementation\n```\n\n**Acceptance Criteria:**\n- Only one fileExists function exists (in utils/fs.ts)\n- detect.ts imports from utils/fs\n- No barrel export conflicts","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-02T21:14:49.894382-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T21:19:02.484338-06:00","closed_at":"2026-02-02T21:19:02.484338-06:00","close_reason":"Closed"}
{"id":"uncov-ocy","title":"Implement CLI entry point with command routing","description":"Complete src/cli.ts as the main entry point.\n\n**Responsibilities:**\n- Parse top-level args to determine command\n- Route to appropriate command handler\n- Handle --help and --version flags\n- Graceful error handling with user-friendly messages\n\n**Commands to Route:**\n- (default/no command) → report command\n- `init` → init command\n- `check` → check command\n\n**Global Flags:**\n- `--help, -h` - Show help text\n- `--version, -v` - Show version from package.json\n\n**Help Output:**\n```\nuncov - Report files with low test coverage\n\nUsage: uncov [command] [options]\n\nCommands:\n  (default)  Report files below coverage threshold\n  init       Bootstrap coverage configuration\n  check      Verify coverage setup\n\nOptions:\n  --threshold \u003cn\u003e  Coverage threshold percentage (default: 10)\n  --fail           Exit 1 if files below threshold\n  --json           Output as JSON\n  --help, -h       Show this help\n  --version, -v    Show version\n```\n\n**Error Handling:**\n- Unknown command → suggest similar, show help\n- Missing required args → show specific error + help\n\n**Tests Required:** test/cli.test.ts","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-02T20:52:30.532892-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T21:47:19.802583-06:00","closed_at":"2026-02-02T21:47:19.802583-06:00","close_reason":"Closed","dependencies":[{"issue_id":"uncov-ocy","depends_on_id":"uncov-3ky","type":"blocks","created_at":"2026-02-02T20:56:07.346017-06:00","created_by":"loganlindquist"}]}
{"id":"uncov-p0r","title":"Implement coverage.ts: parse Istanbul coverage-summary.json","description":"Create src/lib/coverage.ts to parse Vitest/Istanbul coverage output.\n\n**Input Format:** coverage/coverage-summary.json (Istanbul standard)\n```json\n{\n  \"total\": { \"lines\": { \"total\": 1000, \"covered\": 500, \"pct\": 50 }, ... },\n  \"src/file.ts\": { \"lines\": { \"total\": 100, \"covered\": 10, \"pct\": 10 }, ... }\n}\n```\n\n**Functions to Implement:**\n- `parseCoverageSummary(path: string): CoverageData` - Read and parse JSON\n- `filterBelowThreshold(data: CoverageData, threshold: number): FileEntry[]` - Filter files at or below threshold\n- `sortByPercentage(files: FileEntry[]): FileEntry[]` - Sort ascending by coverage %\n\n**Types to Define:**\n- `CoverageData` - Parsed coverage structure\n- `FileEntry` - Single file with path, lines hit/found, percentage\n\n**Error Handling:**\n- File not found → throw descriptive error\n- Invalid JSON → throw descriptive error\n- Missing required fields → throw descriptive error\n\n**Tests Required:** test/lib/coverage.test.ts with fixture files","status":"open","priority":1,"issue_type":"task","created_at":"2026-02-02T20:52:10.97738-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T20:52:10.97738-06:00","dependencies":[{"issue_id":"uncov-p0r","depends_on_id":"uncov-3ky","type":"blocks","created_at":"2026-02-02T20:56:07.591341-06:00","created_by":"loganlindquist"},{"issue_id":"uncov-p0r","depends_on_id":"uncov-ed6","type":"blocks","created_at":"2026-02-02T20:56:07.702419-06:00","created_by":"loganlindquist"},{"issue_id":"uncov-p0r","depends_on_id":"uncov-qu3","type":"blocks","created_at":"2026-02-02T20:56:07.816536-06:00","created_by":"loganlindquist"}]}
{"id":"uncov-p2k","title":"Write comprehensive README.md documentation","description":"Create README.md with full documentation.\n\n**Sections:**\n\n**1. Header**\n- Project name and tagline\n- Badges (CI status, version, license)\n\n**2. Features**\n- Zero dependencies\n- Single binary\n- Cross-platform\n- No config required\n\n**3. Installation**\n- curl install script\n- Homebrew (when available)\n- Download from releases\n- Build from source\n\n**4. Quick Start**\n```bash\n# Generate coverage with vitest\npnpm test:coverage\n\n# Report low coverage files\nuncov\n\n# Files below 50% coverage\nuncov --threshold 50\n\n# Fail CI if low coverage\nuncov --fail\n```\n\n**5. Commands**\n- uncov (default) - detailed usage\n- uncov init - detailed usage\n- uncov check - detailed usage\n\n**6. Configuration**\n- uncov.config.json format\n- package.json format\n- CLI flags reference\n\n**7. Exit Codes**\n- Table of codes and meanings\n\n**8. Development**\n- Prerequisites (Bun)\n- Setup instructions\n- Running tests\n- Building locally\n\n**9. License**\n- MIT\n\n**Keep concise** - link to docs/spec.md for full details","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-02T20:55:28.558758-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T20:55:28.558758-06:00","dependencies":[{"issue_id":"uncov-p2k","depends_on_id":"uncov-38c","type":"blocks","created_at":"2026-02-02T20:56:18.313896-06:00","created_by":"loganlindquist"}]}
{"id":"uncov-q77","title":"Implement format.ts: output formatting utilities","description":"Create src/utils/format.ts for consistent output formatting.\n\n**Functions to Implement:**\n\n`formatCoverageTable(files: FileEntry[]): string`\n- Format output like:\n  ```\n  Files at or below 10% line coverage: 3\n\n    0.00%  LH    0/LF  120   src/renderer.ts\n    5.26%  LH    2/LF   38   src/bootstrap.ts\n   10.00%  LH   10/LF  100   src/engine.ts\n  ```\n- Right-align percentage column\n- LH = lines hit, LF = lines found\n\n`formatJson(files: FileEntry[]): string`\n- JSON array output for --json flag\n- Include: path, percentage, linesHit, linesFound\n\n`formatSummary(count: number, threshold: number): string`\n- Header line: 'Files at or below X% line coverage: N'\n\n**Tests Required:** test/utils/format.test.ts","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-02T20:52:11.201581-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T21:47:19.771775-06:00","closed_at":"2026-02-02T21:47:19.771775-06:00","close_reason":"Closed","dependencies":[{"issue_id":"uncov-q77","depends_on_id":"uncov-3ky","type":"blocks","created_at":"2026-02-02T20:56:07.23294-06:00","created_by":"loganlindquist"}]}
{"id":"uncov-qu3","title":"Create test fixtures: sample coverage-summary.json files","description":"Create test/fixtures/ with sample Istanbul coverage data for testing.\n\n**Fixtures to Create:**\n\n**test/fixtures/coverage-summary-valid.json**\n- Standard valid coverage output\n- Multiple files with varying coverage (0%, 10%, 50%, 100%)\n- Include 'total' summary\n\n**test/fixtures/coverage-summary-empty.json**\n- Valid JSON but only 'total' with no individual files\n\n**test/fixtures/coverage-summary-all-covered.json**\n- All files at 100% coverage\n\n**test/fixtures/coverage-summary-all-zero.json**\n- All files at 0% coverage\n\n**test/fixtures/coverage-summary-invalid.json**\n- Malformed JSON for error testing\n\n**test/fixtures/coverage-summary-missing-fields.json**\n- Valid JSON but missing required fields\n\n**Sample Valid Structure:**\n```json\n{\n  \"total\": {\n    \"lines\": { \"total\": 1000, \"covered\": 450, \"skipped\": 0, \"pct\": 45 },\n    \"statements\": { \"total\": 1000, \"covered\": 450, \"skipped\": 0, \"pct\": 45 },\n    \"functions\": { \"total\": 100, \"covered\": 50, \"skipped\": 0, \"pct\": 50 },\n    \"branches\": { \"total\": 200, \"covered\": 80, \"skipped\": 0, \"pct\": 40 }\n  },\n  \"src/renderer.ts\": {\n    \"lines\": { \"total\": 120, \"covered\": 0, \"skipped\": 0, \"pct\": 0 },\n    ...\n  },\n  \"src/engine.ts\": {\n    \"lines\": { \"total\": 100, \"covered\": 10, \"skipped\": 0, \"pct\": 10 },\n    ...\n  }\n}\n```","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-02T20:55:28.053333-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T21:47:19.742065-06:00","closed_at":"2026-02-02T21:47:19.742065-06:00","close_reason":"Closed","dependencies":[{"issue_id":"uncov-qu3","depends_on_id":"uncov-3ky","type":"blocks","created_at":"2026-02-02T20:56:07.118652-06:00","created_by":"loganlindquist"}]}
{"id":"uncov-s2m","title":"Implement vitest-config.ts: detect and modify vitest configuration","description":"Create src/lib/vitest-config.ts for vitest config management.\n\n**Functions to Implement:**\n\n`hasVitestConfig(): boolean`\n- Check for vitest.config.* or vite.config.* with test section\n\n`hasCoverageConfig(): boolean`\n- Check if coverage is already configured in vitest config\n\n`createVitestConfig(): string`\n- Generate new vitest.config.ts content:\n```typescript\nimport { defineConfig } from 'vitest/config';\n\nexport default defineConfig({\n  test: {\n    coverage: {\n      provider: 'v8',\n      reporter: ['text', 'json-summary'],\n      reportsDirectory: './coverage',\n    },\n  },\n});\n```\n\n`patchVitestConfig(existingContent: string): string`\n- Add coverage config to existing vitest.config.ts\n- Use AST manipulation or careful string manipulation\n- Preserve existing config, only add coverage section\n\n**Edge Cases:**\n- vite.config.ts with test section (common pattern)\n- vitest.workspace.ts (workspace setups)\n- Already has partial coverage config\n\n**Tests Required:** test/lib/vitest-config.test.ts","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-02T20:52:49.816751-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T20:52:49.816751-06:00","dependencies":[{"issue_id":"uncov-s2m","depends_on_id":"uncov-3ky","type":"blocks","created_at":"2026-02-02T20:56:09.109874-06:00","created_by":"loganlindquist"},{"issue_id":"uncov-s2m","depends_on_id":"uncov-ed6","type":"blocks","created_at":"2026-02-02T20:56:09.222726-06:00","created_by":"loganlindquist"}]}
{"id":"uncov-tr8","title":"Fix: Remove deprecated async wrappers from fs.ts","description":"**Severity:** Medium\n**Location:** src/utils/fs.ts lines 127-145\n\n**Issue:** Deprecated async wrappers (readJsonFile, writeJsonFile) are misleading:\n- Not truly async (no await, just wrapped in Promise)\n- Silently swallow errors by returning null\n- Have no tests\n\n**The Fix:**\nRemove the deprecated functions entirely (lines 126-145):\n```typescript\n// Delete these deprecated functions:\n// - readJsonFile\n// - writeJsonFile\n```\n\nAlso remove any exports of these functions from index.ts.\n\n**Acceptance Criteria:**\n- Deprecated async wrappers are removed\n- No references to removed functions\n- Lint passes","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-02-02T21:43:39.770187-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T21:47:19.641811-06:00","closed_at":"2026-02-02T21:47:19.641811-06:00","close_reason":"Closed"}
{"id":"uncov-xg6","title":"Fix: Add unrecognized command handling","description":"**Issue:** Running `uncov foobar` silently defaults to the report command. This confuses users who misspell commands.\n\n**Location:** src/cli.ts lines 71-78\n\n**The Fix:**\n```typescript\nconst command = positionals[0];\nlet parsedCommand: 'report' | 'init' | 'check' = 'report';\n\nif (command === 'init') {\n  parsedCommand = 'init';\n} else if (command === 'check') {\n  parsedCommand = 'check';\n} else if (command \u0026\u0026 command \\!== 'report') {\n  console.error(`Unknown command: ${command}`);\n  console.error(`Run 'uncov --help' for usage information.`);\n  process.exit(2);\n}\n```\n\n**Acceptance Criteria:**\n- `uncov foobar` shows 'Unknown command: foobar' and exits 2\n- `uncov report` works normally\n- `uncov` (no command) defaults to report","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-02-02T21:16:14.226737-06:00","created_by":"loganlindquist","updated_at":"2026-02-02T21:21:13.425374-06:00","closed_at":"2026-02-02T21:21:13.425374-06:00","close_reason":"Closed"}
